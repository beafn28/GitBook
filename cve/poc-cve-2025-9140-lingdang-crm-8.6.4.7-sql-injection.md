# PoC - CVE-2025-9140 (Lingdang CRM 8.6.4.7) — SQL Injection

{% embed url="https://www.exploit-db.com/exploits/52420" %}

**Resumen**\
Desarrollé una Proof of Concept (PoC) que demuestra una vulnerabilidad de _SQL Injection_ en Lingdang CRM versión ≤ 8.6.4.7. La PoC fue verificada y publicada en Exploit Database (EDB-ID 52420). Esta entrada documenta el vector afectado, las técnicas usadas en la PoC, el entorno de prueba y recomendaciones de mitigación.

### Detalle técnico

* **Producto afectado:** Lingdang CRM
* **Versión:** ≤ 8.6.4.7 (fix en 8.6.5+)
* **CVE:** CVE-2025-9140
* **Endpoint vulnerable:** `/crm/crmapi/erp/tabdetail_moduleSave.php`
* **Parámetro:** `getvaluestring` (GET/POST)
* **Tipo de vulnerabilidad:** Blind SQL Injection (time-based / boolean)

### Descripción de la PoC

La PoC implementa técnicas de _time-based blind_ (SLEEP) y _boolean-based_ para evidenciar la inyección en el parámetro `getvaluestring`. Las pruebas se realizaron exclusivamente en entornos de laboratorio (LAMP, PHP 7/8) y están orientadas a demostrar la existencia y el impacto de la vulnerabilidad sin explotar objetivos reales en producción.

**Comportamiento demostrado**

* Retrasos significativos en la respuesta al inyectar `SLEEP()` (indicación de time-based blind SQLi).
* Variaciones en el contenido/respuesta al usar condiciones booleanas (`OR 1=1` vs `OR 1=2`), según despliegue.

### Entorno de pruebas

* Plataforma: Generic LAMP stack (Linux + Apache/Nginx + MySQL/MariaDB + PHP 7/8)
* Herramientas empleadas: `curl`, scripts Python (requests), entorno local/VMs controladas

{% hint style="warning" %}
**Nota**: la PoC está diseñada para usarse en laboratorios y **NO** debe ejecutarse contra sistemas en producción sin autorización expresa del propietario.
{% endhint %}

### Impacto

Un atacante remoto y no autenticado puede explotar esta vulnerabilidad para:

* Exfiltrar datos (confidencialidad) mediante técnicas blind SQLi.
* Alterar respuestas y comportamiento de la aplicación (integridad).
* Provocar latencias o denegaciones parciales (disponibilidad), dependiendo del payload.

(CWE-89: SQL Injection)

### Mitigaciones recomendadas

1. Adoptar consultas parametrizadas / prepared statements para el manejo de `getvaluestring`.
2. Validación y saneamiento en servidor, aplicar allow-list de entradas esperadas.
3. Implementar reglas WAF específicas para bloquear patrones de SQLi en la ruta afectada.
4. Revisar y actualizar la versión del producto a 8.6.5+ (según advisory del vendor).

### Referencias

* Exploit DB: [https://www.exploit-db.com/exploits/52420](https://www.exploit-db.com/exploits/52420)
* NVD (CVE-2025-9140): [https://nvd.nist.gov/vuln/detail/CVE-2025-9140](https://nvd.nist.gov/vuln/detail/CVE-2025-9140)

{% hint style="danger" %}
La información técnica aquí expuesta es para fines formativos y de investigación. No utilices la PoC contra sistemas que no te pertenecen o sin permiso explícito. Siempre seguir buenas prácticas de _responsible disclosure_.
{% endhint %}
