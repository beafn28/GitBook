# PoC - CVE-2025-10666 (D-Link DIR-825 Rev.B ≤ 2.10) - Stack Buffer Overflow (DoS)

{% embed url="https://www.exploit-db.com/exploits/52469" %}

#### Resumen

Se desarrolló una **Proof of Concept (PoC)** que demuestra una vulnerabilidad de **stack-based buffer overflow** en el router **D-Link DIR-825 Rev.B** (firmware ≤ 2.10). La vulnerabilidad permite provocar una **Denegación de Servicio (DoS)** mediante el envío de un parámetro POST excesivamente largo al endpoint vulnerable.

La PoC fue **verificada y publicada en Exploit Database** (**EDB-ID 52469**). Esta entrada documenta el vector afectado, el comportamiento observado, el entorno de pruebas y las recomendaciones de mitigación.

#### Detalle técnico

* **Producto afectado:** D-Link DIR-825 Rev.B
* **Firmware:** ≤ 2.10
* **CVE:** CVE-2025-10666
* **Endpoint vulnerable:** `/apply.cgi`
* **Parámetro:** `countdown_time`
* **Tipo de vulnerabilidad:** Stack-Based Buffer Overflow
* **Impacto principal:** Denial of Service (DoS)
* **Vector de ataque:** Red local
* **Plataforma:** Hardware / Router

#### Descripción de la PoC

La PoC demuestra que el parámetro `countdown_time` es copiado en un **buffer de tamaño fijo en la pila** sin una validación adecuada de longitud.

Al enviar un valor excesivamente largo mediante una petición HTTP POST, se provoca un **desbordamiento de buffer en la pila**, causando la caída del proceso responsable de gestionar la petición.

Las pruebas se realizaron exclusivamente en un **entorno controlado de laboratorio** sobre hardware físico, con el objetivo de validar el impacto real de la vulnerabilidad sin afectar a dispositivos en producción.

#### Comportamiento demostrado

* Caída del proceso vulnerable.
* Router inaccesible temporalmente.
* Necesidad de reinicio manual del dispositivo para recuperar el servicio.
* Confirmación de ausencia de controles de longitud en el parámetro afectado.

#### Entorno de pruebas

* **Dispositivo:** D-Link DIR-825 Rev.B (hardware físico)
* **Firmware:** v2.10
* **Red:** Entorno local
* **Herramientas empleadas:**
  * Python
  * requests
  * HTTP POST manual / fuzzing básico

#### Impacto

Un atacante con acceso a la red local puede explotar esta vulnerabilidad para:

* Provocar una **denegación de servicio** del router.
* Interrumpir la conectividad de red de los usuarios.
* Forzar reinicios frecuentes del dispositivo.

Aunque no se demuestra ejecución de código, el impacto sobre la **disponibilidad** del sistema es significativo.

#### Mitigaciones recomendadas

* Validar estrictamente la longitud de todos los parámetros POST.
* Implementar comprobaciones de límites antes de copiar datos a buffers en pila.
* Restringir el acceso a la interfaz administrativa desde redes no confiables.
* Actualizar el firmware si el fabricante publica una versión corregida.
* Aislar el dispositivo en redes segmentadas cuando sea posible.

#### Referencias

* **Exploit Database:** [https://www.exploit-db.com/exploits/52469](https://www.exploit-db.com/exploits/52469)
* **CVE Record:** [https://nvd.nist.gov/vuln/detail/CVE-2025-10666](https://nvd.nist.gov/vuln/detail/CVE-2025-10666)

{% hint style="danger" %}
Esta PoC ha sido desarrollada únicamente con fines de investigación y formación. No debe ejecutarse contra sistemas en producción ni dispositivos sin autorización expresa. Seguir siempre prácticas de _responsible disclosure_.
{% endhint %}
